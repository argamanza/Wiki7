<?php
# This file was automatically generated by the MediaWiki 1.43.1 installer.
# Manual changes are allowed here.
# See includes/MainConfigSchema.php for all configurable settings.

# Protect against web entry
if ( !defined( 'MEDIAWIKI' ) ) {
	exit;
}

## Basic Site Settings
$wgSitename = "ויקישבע"; // Wiki name
$wgScriptPath = ""; // URL base path (empty = root)

## Resource Paths
$wgResourceBasePath = $wgScriptPath;

## Database Settings
$wgDBtype = "mysql";
$wgDBserver   = getenv('MEDIAWIKI_DB_HOST'); // DB server via ENV
$wgDBname     = getenv('MEDIAWIKI_DB_NAME'); // DB name via ENV
$wgDBuser     = getenv('MEDIAWIKI_DB_USER'); // DB user via ENV
$wgDBpassword = getenv('MEDIAWIKI_DB_PASSWORD'); // DB password via ENV

# MySQL specific options
$wgDBprefix = "";
$wgDBssl = false;
$wgDBTableOptions = "ENGINE=InnoDB, DEFAULT CHARSET=binary";
$wgSharedTables[] = "actor"; // Shared actor table if needed

## Email Settings
$wgEnableEmail = true;
$wgEnableUserEmail = true; // Allow users to send emails to each other
$wgEmergencyContact = "info@wiki7.co.il"; // System email contact
$wgPasswordSender = "info@wiki7.co.il"; // Email sender address
$wgEnotifUserTalk = false;
$wgEnotifWatchlist = false;
$wgEmailAuthentication = true; // Require email confirmation

## Upload Settings
$wgEnableUploads = true;
$wgUseImageMagick = true;
$wgImageMagickConvertCommand = "/usr/bin/convert";

# InstantCommons allows using images from Wikimedia Commons
$wgUseInstantCommons = false;

## Language and Localization
$wgLanguageCode = "he"; // Hebrew
$wgLocaltimezone = "Asia/Jerusalem"; // Server timezone

## Security Settings
$wgSecretKey = "137d670eceb1b6da8ecd51f3493aab7215e43ef79a9d27072655db73dfa2d3d5"; // Site secret
$wgAuthenticationTokenVersion = "1";
$wgUpgradeKey = "c23cfd79cbaf67f8"; // Upgrade key for web installer

## Cache Settings (Overridden below per environment)
$wgMainCacheType = CACHE_ACCEL;
$wgMemCachedServers = [];

## Rights and Permissions
$wgGroupPermissions["*"]["edit"] = false; // Prevent anonymous edits

## Skins
wfLoadSkin( 'Vector' );
wfLoadSkin( 'Wiki7Skin' );

$wgDefaultSkin = 'Vector';

# Other available skins (commented out)
// wfLoadSkin( 'MinervaNeue' );
// wfLoadSkin( 'MonoBook' );
// wfLoadSkin( 'Timeless' );
// wfLoadSkin( 'Vector' );

## Extensions
wfLoadExtension( 'CategoryTree' );
wfLoadExtension( 'Cite' );
wfLoadExtension( 'ConfirmEdit' );
wfLoadExtension( 'Echo' );
wfLoadExtension( 'LoginNotify' );
wfLoadExtension( 'ParserFunctions' );
wfLoadExtension( 'Scribunto' );
wfLoadExtension( 'SyntaxHighlight_GeSHi' );
wfLoadExtension( 'TemplateData' );
wfLoadExtension( 'Thanks' );
wfLoadExtension( 'VisualEditor' );
wfLoadExtension( 'WikiEditor' );

## Logo
$wgLogos = [
	'1x' => "$wgResourceBasePath/resources/assets/change-your-logo.svg",
	'icon' => "$wgResourceBasePath/resources/assets/change-your-logo.svg",
];

## Pingback
$wgPingback = true; // Help MediaWiki devs by sending anonymous usage stats

# --- Environment-specific settings ---
# Switches behavior based on WIKI_ENV ("production" vs development)

if ( getenv('WIKI_ENV') === 'production' ) {
	// Production mode
    $wgServer = "http://Wiki7Alb-2051510885.il-central-1.elb.amazonaws.com";
    $wgShowExceptionDetails = false; // Hide internal error details
    $wgDebugToolbar = false;          // Disable debug toolbar
    $wgCachePages = true;              // Enable page caching
    $wgEnableParserCache = true;       // Enable parsed output cache
    $wgMainCacheType = CACHE_ACCEL;    // Use object cache
    $wgParserCacheType = CACHE_ACCEL;
    $wgCacheDirectory = "/tmp";        // Use local tmp dir for cache if needed
} else {
    // Development mode
    $wgServer = "http://localhost:8080";
    $wgShowExceptionDetails = true;    // Show full error stack traces
    $wgDebugToolbar = true;            // Enable debug toolbar in UI
    $wgCachePages = false;             // Disable page caching for live changes
    $wgEnableParserCache = false;      // Disable parsed output cache
    $wgMainCacheType = CACHE_NONE;     // No object caching
    $wgParserCacheType = CACHE_NONE;
    $wgCacheDirectory = false;         // Disable file cache
    $wgDevelopmentWarnings = true;     // (optional) show PHP notices
    $wgDebugLogFile = "/tmp/mediawiki-debug.log"; // (optional) log debug to file
}

# --- End of environment-specific settings ---

$wgShowExceptionDetails = true;
$wgShowDBErrorBacktrace = true;
